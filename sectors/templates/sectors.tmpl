// ==========================================
// Step 1: Strip Exchange Prefix
cleanT_step1 = str.replace_all(syminfo.ticker, ".*:", "")
// Step 2: Strip Suffixes like .T or -B
cleanT = str.replace_all(cleanT_step1, "[.\\-].*$", "")

// Use empty strings instead of na for safety in request.security
string currentSector = "unknown"
string s01 = "", string s02 = "", string s03 = "", string s04 = "", string s05 = ""
string s06 = "", string s07 = "", string s08 = "", string s09 = "", string s10 = ""

// --- Index Sector Group ---
if cleanT == "SPY" or cleanT == "QQQ" or cleanT == "IWM" or cleanT == "DIA"
    currentSector := cleanT, s01 := "SPY", s02 := "QQQ", s03 := "IWM", s04 := "DIA"
{{ range $sector, $stocks := .Sectors -}}
else if cleanT == "{{ $sector }}"{{ range $stocks }} or cleanT == "{{ . }}"{{ end }}
    currentSector := "{{ $sector }}", s01 := "{{ getHolding $stocks 0 }}", s02 := "{{ getHolding $stocks 1 }}", s03 := "{{ getHolding $stocks 2 }}", s04 := "{{ getHolding $stocks 3 }}", s05 := "{{ getHolding $stocks 4 }}", s06 := "{{ getHolding $stocks 5 }}", s07 := "{{ getHolding $stocks 6 }}", s08 := "{{ getHolding $stocks 7 }}", s09 := "{{ getHolding $stocks 8 }}", s10 := "{{ getHolding $stocks 9 }}"
{{ end }}
else
    currentSector := "unknown"